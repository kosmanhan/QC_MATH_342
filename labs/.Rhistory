#d = 2R × sin⁻¹(√[sin²((θ₂ - θ₁)/2) + cosθ₁ × cosθ₂ × sin²((φ₂ - φ₁)/2)
null_mean=mean(storms$wind)#the null mean is 49.29377
storms %>%
group_by(name) %>%
summarize(y=max(wind),
x_1=wind[1],
x_2=wind[2],
x_3=wind[3],
distance= 2*R*asin(sqrt(sin((lat[3]-lat[1])/2)^2 + cos(lat[1]) * cos(lat[3]) *
sin((long[3]-long[1])/2)^2)),
predicted_max_wind_speed = (x_1*x_2*x_3*null_mean/distance
)
#wind speeds at first three readings, airdistance covered, winddistance covered.
#d = 2R × sin⁻¹(√[sin²((θ₂ - θ₁)/2) + cosθ₁ × cosθ₂ × sin²((φ₂ - φ₁)/2)
null_mean=mean(storms$wind)#the null mean is 49.29377
storms %>%
group_by(name) %>%
summarize(y=max(wind),
x_1=wind[1],
x_2=wind[2],
x_3=wind[3],
distance= 2*R*asin(sqrt(sin((lat[3]-lat[1])/2)^2 + cos(lat[1]) * cos(lat[3]) *
sin((long[3]-long[1])/2)^2)),
predicted_max_wind_speed = x_1*x_2*x_3*null_mean/distance
)
#wind speeds at first three readings, airdistance covered, winddistance covered.
#d = 2R × sin⁻¹(√[sin²((θ₂ - θ₁)/2) + cosθ₁ × cosθ₂ × sin²((φ₂ - φ₁)/2)
null_mean=mean(storms$wind)#the null mean is 49.29377
storms %>%
group_by(name) %>%
summarize(y=max(wind),
x_1=wind[1],
x_2=wind[2],
x_3=wind[3],
distance= 2*R*asin(sqrt(sin((lat[3]-lat[1])/2)^2 + cos(lat[1]) * cos(lat[3]) *
sin((long[3]-long[1])/2)^2)),
predicted_max_wind_speed = x_1*x_2*x_3*null_mean/distance^2
)
#wind speeds at first three readings, airdistance covered, winddistance covered.
#d = 2R × sin⁻¹(√[sin²((θ₂ - θ₁)/2) + cosθ₁ × cosθ₂ × sin²((φ₂ - φ₁)/2)
null_mean=mean(storms$wind)#the null mean is 49.29377
storms %>%
group_by(name) %>%
summarize(y=max(wind),
x_1=wind[1],
x_2=wind[2],
x_3=wind[3],
distance= 2*R*asin(sqrt(sin((lat[3]-lat[1])/2)^2 + cos(lat[1]) * cos(lat[3]) *
sin((long[3]-long[1])/2)^2)),
predicted_max_wind_speed = x_1*x_2*x_3*null_mean/distance^1.2
)
#wind speeds at first three readings, airdistance covered, winddistance covered.
#d = 2R × sin⁻¹(√[sin²((θ₂ - θ₁)/2) + cosθ₁ × cosθ₂ × sin²((φ₂ - φ₁)/2)
null_mean=mean(storms$wind)#the null mean is 49.29377
storms %>%
group_by(name) %>%
summarize(y=max(wind),
x_1=wind[1],
x_2=wind[2],
x_3=wind[3],
distance= 2*R*asin(sqrt(sin((lat[3]-lat[1])/2)^2 + cos(lat[1]) * cos(lat[3]) *
sin((long[3]-long[1])/2)^2)),
predicted_max_wind_speed = x_1*x_2*x_3*null_mean/distance^1.5
)
#wind speeds at first three readings, airdistance covered, winddistance covered.
#d = 2R × sin⁻¹(√[sin²((θ₂ - θ₁)/2) + cosθ₁ × cosθ₂ × sin²((φ₂ - φ₁)/2)
null_mean=mean(storms$wind)#the null mean is 49.29377
storms %>%
group_by(name) %>%
summarize(y=max(wind),
x_1=wind[1],
x_2=wind[2],
x_3=wind[3],
distance= 2*R*asin(sqrt(sin((lat[3]-lat[1])/2)^2 + cos(lat[1]) * cos(lat[3]) *
sin((long[3]-long[1])/2)^2)),
predicted_max_wind_speed = x_1*x_2*x_3*null_mean/distance^1.1
)
#wind speeds at first three readings, airdistance covered, winddistance covered.
#d = 2R × sin⁻¹(√[sin²((θ₂ - θ₁)/2) + cosθ₁ × cosθ₂ × sin²((φ₂ - φ₁)/2)
null_mean=mean(storms$wind)#the null mean is 49.29377
storms %>%
group_by(name) %>%
summarize(y=max(wind),
x_1=wind[1],
x_2=wind[2],
x_3=wind[3],
distance= 2*R*asin(sqrt(sin((lat[3]-lat[1])/2)^2 + cos(lat[1]) * cos(lat[3]) *
sin((long[3]-long[1])/2)^2)),
predicted_max_wind_speed = x_1*x_2*x_3*null_mean/distance
)
#wind speeds at first three readings, airdistance covered, winddistance covered.
#d = 2R × sin⁻¹(√[sin²((θ₂ - θ₁)/2) + cosθ₁ × cosθ₂ × sin²((φ₂ - φ₁)/2)
null_mean=mean(storms$wind)#the null mean is 49.29377
storms %>%
group_by(name) %>%
summarize(y=max(wind),
x_1=wind[1],
x_2=wind[2],
x_3=wind[3],
ground_distance= 2*R*asin(sqrt(sin((lat[3]-lat[1])/2)^2 + cos(lat[1]) * cos(lat[3]) *
sin((long[3]-long[1])/2)^2)),
wind_distance=mean(wind[1]+wind[2]+wind[3]),
predicted_max_wind_speed = x_1*x_2*x_3*null_mean/distance
)
#wind speeds at first three readings, airdistance covered, winddistance covered.
#d = 2R × sin⁻¹(√[sin²((θ₂ - θ₁)/2) + cosθ₁ × cosθ₂ × sin²((φ₂ - φ₁)/2)
null_mean=mean(storms$wind)#the null mean is 49.29377
storms %>%
group_by(name) %>%
summarize(y=max(wind),
x_1=wind[1],
x_2=wind[2],
x_3=wind[3],
ground_distance= 2*R*asin(sqrt(sin((lat[3]-lat[1])/2)^2 + cos(lat[1]) * cos(lat[3]) *
sin((long[3]-long[1])/2)^2)),
wind_distance=mean(wind[1]+wind[2]+wind[3]),
predicted_max_wind_speed = x_1*x_2*x_3*wind_distance/ground_distance
)
#wind speeds at first three readings, airdistance covered, winddistance covered.
#d = 2R × sin⁻¹(√[sin²((θ₂ - θ₁)/2) + cosθ₁ × cosθ₂ × sin²((φ₂ - φ₁)/2)
null_mean=mean(storms$wind)#the null mean is 49.29377
storms %>%
group_by(name) %>%
summarize(y=max(wind),
x_1=wind[1],
x_2=wind[2],
x_3=wind[3],
ground_distance= 2*R*asin(sqrt(sin((lat[3]-lat[1])/2)^2 + cos(lat[1]) * cos(lat[3]) *
sin((long[3]-long[1])/2)^2)),
wind_distance=mean(wind[1]+wind[2]+wind[3]),
predicted_max_wind_speed = (x_1/2)*(2*x_2)*(x_3/2)*wind_distance/ground_distance
)
#wind speeds at first three readings, airdistance covered, winddistance covered.
#d = 2R × sin⁻¹(√[sin²((θ₂ - θ₁)/2) + cosθ₁ × cosθ₂ × sin²((φ₂ - φ₁)/2)
null_mean=mean(storms$wind)#the null mean is 49.29377
storms_model = storms %>%
group_by(name) %>%
summarize(y=max(wind),
x_1=wind[1],
x_2=wind[2],
x_3=wind[3],
ground_distance= 2*R*asin(sqrt(sin((lat[3]-lat[1])/2)^2 + cos(lat[1]) * cos(lat[3]) *
sin((long[3]-long[1])/2)^2)),
wind_distance=mean(wind[1]+wind[2]+wind[3]),
predicted_max_wind_speed = (x_1/2)*(2*x_2)*(x_3/2)*wind_distance/ground_distance
)
storms_model
model = lm(y ~ 0 + ., data = storms_model)
summary(model)
#wind speeds at first three readings, airdistance covered, winddistance covered.
#d = 2R × sin⁻¹(√[sin²((θ₂ - θ₁)/2) + cosθ₁ × cosθ₂ × sin²((φ₂ - φ₁)/2)
null_mean=mean(storms$wind)#the null mean is 49.29377
storms_model = storms %>%
group_by(name) %>%
summarize(y=max(wind),
x_1=wind[1],
x_2=wind[2],
x_3=wind[3],
ground_distance= 2*R*asin(sqrt(sin((lat[3]-lat[1])/2)^2 + cos(lat[1]) * cos(lat[3]) *
sin((long[3]-long[1])/2)^2)),
wind_distance=mean(wind[1]+wind[2]+wind[3]),
yhat = (x_1/2)*(2*x_2)*(x_3/2)*wind_distance/ground_distance
)
model = lm(y ~ 0 + ., data = storms_model)
summary(model)
#wind speeds at first three readings, airdistance covered, winddistance covered.
#d = 2R × sin⁻¹(√[sin²((θ₂ - θ₁)/2) + cosθ₁ × cosθ₂ × sin²((φ₂ - φ₁)/2)
null_mean=mean(storms$wind)#the null mean is 49.29377
storms_model = storms %>%
group_by(name) %>%
summarize(y=max(wind),
x_1=wind[1],
x_2=wind[2],
x_3=wind[3],
ground_distance= 2*R*asin(sqrt(sin((lat[3]-lat[1])/2)^2 + cos(lat[1]) * cos(lat[3]) *
sin((long[3]-long[1])/2)^2)),
wind_distance=mean(wind[1]+wind[2]+wind[3]),
predicted_max_wind = (x_1/2)*(2*x_2)*(x_3/2)*wind_distance/ground_distance
)
model = lm(y ~ predicted_max_wind, data = storms_model)
summary(model)
model = lm(y ~ predicted_max_wind, data = storms_model)
summary(model)
n = nrow(storms_model)
K = 10
test_indices = sample(1 : n, 1 / K * n)
train_indices = setdiff(1 : n, test_indices)
X = select(storms_model, -y)
y = storms_model$y
X_train = X[train_indices, ]
y_train = y[train_indices]
X_test = X[test_indices, ]
y_test = y[test_indices]
modelvalidation = lm(y_train ~ ., data.frame(X_train))
yhat_oos = predict(model, data.frame(X_test))
oos_residuals = y_test - yhat_oos
sd(modelvalidation$residuals) - sd(oos_residuals)
head(cbind(y_test, yhat_oos))
oos_residuals
model = lm(y ~ predicted_max_wind, data = storms_model)
summary(model)
n = nrow(storms_model)
K = 10
test_indices = sample(1 : n, 1 / K * n)
train_indices = setdiff(1 : n, test_indices)
X = select(storms_model, -y)
y = storms_model$y
X_train = X[train_indices, ]
y_train = y[train_indices]
X_test = X[test_indices, ]
y_test = y[test_indices]
modelvalidation = lm(y_train ~ predicted_max_wind, data = X_train)
yhat_oos = predict(model, data.frame(X_test))
oos_residuals = y_test - yhat_oos
sd(modelvalidation$residuals) - sd(oos_residuals)
head(cbind(y_test, yhat_oos))
model = lm(y ~ predicted_max_wind, data = storms_model)
summary(model)
n = nrow(storms_model)
K = 10
test_indices = sample(1 : n, 1 / K * n)
train_indices = setdiff(1 : n, test_indices)
X = select(storms_model, -y)
y = storms_model$y
X_train = X[train_indices, ]
y_train = y[train_indices]
X_test = X[test_indices, ]
y_test = y[test_indices]
modelvalidation = lm(y_train ~ predicted_max_wind, data = X_train)
yhat_oos = predict(model, X_test)
oos_residuals = y_test - yhat_oos
sd(modelvalidation$residuals) - sd(oos_residuals)
head(cbind(y_test, yhat_oos))
oos_residuals = y_test - yhat_oos
oos_residuals
model = lm(y ~ predicted_max_wind, data = storms_model)
summary(model)
n = nrow(storms_model)
K = 10
test_indices = sample(1 : n, 1 / K * n)
train_indices = setdiff(1 : n, test_indices)
X = select(storms_model, -y)
y = storms_model$y
X_train = X[train_indices, ]
y_train = y[train_indices]
X_test = X[test_indices, ]
y_test = y[test_indices]
modelvalidation = lm(y_train ~ predicted_max_wind, data = X_train)
yhat_oos = predict(model, X_test)
oos_residuals = y_test - yhat_oos
sum(oos_residuals)
sum
sum(oos_residuals)
summary(model)$se
oos_SE = y_test - yhat_oos
oos_SSE = sum((y_test - yhat_oos))^2)
model = lm(y ~ predicted_max_wind, data = storms_model)
summary(model)$
n = nrow(storms_model)
model = lm(y ~ predicted_max_wind, data = storms_model)
summary(model)
n = nrow(storms_model)
K = 10
test_indices = sample(1 : n, 1 / K * n)
train_indices = setdiff(1 : n, test_indices)
X = select(storms_model, -y)
y = storms_model$y
X_train = X[train_indices, ]
y_train = y[train_indices]
X_test = X[test_indices, ]
y_test = y[test_indices]
modelvalidation = lm(y_train ~ predicted_max_wind, data = X_train)
yhat_oos = predict(model, X_test)
oos_SSE = sum((y_test - yhat_oos)^2)
model = lm(y ~ predicted_max_wind, data = storms_model)
summary(model)
n = nrow(storms_model)
K = 10
test_indices = sample(1 : n, 1 / K * n)
train_indices = setdiff(1 : n, test_indices)
X = select(storms_model, -y)
y = storms_model$y
X_train = X[train_indices, ]
y_train = y[train_indices]
X_test = X[test_indices, ]
y_test = y[test_indices]
modelvalidation = lm(y_train ~ predicted_max_wind, data = X_train)
oos_yhat = predict(model, X_test)
oos_SSE = sum((y_test - oos_yhat)^2)
summary(model)$sigma
oos_SSE = sum((y_test - oos_yhat)^2)
oos_SSE
summary(modelvalidation)$sigma
summary(model)$sigma
summary(modelvalidation)$sigma
summary(modelvalidation)$sigma
summary(model)$sigma
pacman::p_load(tidyverse, magrittr, data.table)
storms
diplyr::storms
storms = dplyr::storms
rm(list = ls())
storms = dplyr::storms
storms
storms %<>%
filter(!is.na=tropicalstorm_force_diameter, !is.na=hurricane_force_diameter)
rm(list = ls())
storms = dplyr::storms
storms %<>%
filter(!is.na(tropicalstorm_force_diameter), !is.na(hurricane_force_diameter))
storms
rm(list = ls())
storms = dplyr::storms
storms %<>%
filter(!is.na(tropicalstorm_force_diameter), !is.na(hurricane_force_diameter)) %>%
filter(tropicalstorm_force_diameter !=0, hurricane_force_diameter !=0)
storms
storms %>%
group_by(names) %>%
summarize(ts_diameter=tropicalstorm_force_diameter, hu_diameter=hurricane_force_diameter)
storms %>%
group_by(name) %>%
summarize(ts_diameter=tropicalstorm_force_diameter, hu_diameter=hurricane_force_diameter)
storms %>%
group_by(name) %>%
summarize(name=name, ts_diameter=tropicalstorm_force_diameter, hu_diameter=hurricane_force_diameter)
storms %>%
group_by(name) %>%
summarize(name=name, observation_period_number=serial, ts_diameter=tropicalstorm_force_diameter, hu_diameter=hurricane_force_diameter)
storms %>%
group_by(name) %>%
summarize(name=name,
observation_period_number=enumerate,
ts_diameter=tropicalstorm_force_diameter,
hu_diameter=hurricane_force_diameter)
storms %>%
group_by(name) %>%
summarize(name=name,
observation_period_number=names[],
ts_diameter=tropicalstorm_force_diameter,
hu_diameter=hurricane_force_diameter)
storms %>%
summarize(name=name, ts_diameter=tropicalstorm_force_diameter,
hu_diameter=hurricane_force_diameter)
storms %>%
summarize(name=name,
observation_period_number=n(),
ts_diameter=tropicalstorm_force_diameter,
hu_diameter=hurricane_force_diameter)
storms %>%
summarize(name=name,
observation_period_number=name(),
ts_diameter=tropicalstorm_force_diameter,
hu_diameter=hurricane_force_diameter)
storms %>%
summarize(name=name,
ts_diameter=tropicalstorm_force_diameter,
hu_diameter=hurricane_force_diameter)
storms %>%
summarize(name=name,
ts_diameter=tropicalstorm_force_diameter,
hu_diameter=hurricane_force_diameter)
storms %>%
summarize(name=name,
observation_period_number=ifelse(name!=lag(name),1,observation_period_number+1)
ts_diameter=tropicalstorm_force_diameter,
storms %>%
summarize(name=name,
observation_period_number=ifelse(name != lag(name),1,observation_period_number+1
)
ts_diameter=tropicalstorm_force_diameter,
storms %>%
summarize(name=name,
observation_period_number=ifelse(name != lag(name),1,observation_period_number+1
),
ts_diameter=tropicalstorm_force_diameter,
hu_diameter=hurricane_force_diameter)
storms %>%
summarize(name=name,
observation_period_number=ifelse(name != lag(name),1,(observation_period_number+1)
),
ts_diameter=tropicalstorm_force_diameter,
hu_diameter=hurricane_force_diameter)
storms %>%
mutate(observation_period_number=ifelse(name != lag(name),1,(observation_period_number+1)
))
storms %>%
mutate(observation_period_number =
ifelse(name!= lag(name),1,(observation_period_number+1)))
storms %>%
mutate(observation_period_number =
ifelse(name!= lag(name),1,(observation_period_number+1)))
storms %>%
summarize(name=name,
observation_period_number=ifelse(name != lag(name),0,1),
ts_diameter=tropicalstorm_force_diameter,
hu_diameter=hurricane_force_diameter)
storms %>%
summarize(name=name,
observation_period_number=ifelse(name != lag(name),first,1),
ts_diameter=tropicalstorm_force_diameter,
hu_diameter=hurricane_force_diameter)
storms %>%
summarize(name=name,
observation_period_number=ifelse(name != lag(name),'first',1),
ts_diameter=tropicalstorm_force_diameter,
hu_diameter=hurricane_force_diameter)
storms %>%
summarize(name=name,
observation_period_number=ifelse(name != lag(name),'first',1),
ts_diameter=tropicalstorm_force_diameter,
hu_diameter=hurricane_force_diameter)
max(storms$name)
storms
max
max(storms$name)
storms %>%
summarize(name=name,
observation_period_number=ifelse(name != lag(name),'first',1),
ts_diameter=tropicalstorm_force_diameter,
hu_diameter=hurricane_force_diameter)
max(storms$name)
count(storms$name, "Zeta")
count(storms$name, "Zeta")
?count
storms %>%
summarize(name=name,
observation_period_number=ifelse(name != lag(name),'first',1),
ts_diameter=tropicalstorm_force_diameter,
hu_diameter=hurricane_force_diameter)
storms$name$"Zeta"
Zeta
storms$name["Zeta"]
storms$name
count(storms$name)
count(storms$name)
summarize(storms$name)
storms %>%
summarize(name)
storms %>%
summarize(name,count=n())
storms %>%
summarize(name,count=n(name))
summarize(count=n())
storms %>%
group_by(name)
storms %>%
group_by(name)
storms %>%
group_by(name)%>%
summarize(count=n())
storms %>%
group_by(name)%>%
summarize(desc(count=n()))
storms %>%
)
storms %>%
group_by(desc(name))%>%
summarize(count=n())
storms %>%
summarize(name=name,
observation_period_number=ifelse(name != lag(name),'first',1),
ts_diameter=tropicalstorm_force_diameter,
hu_diameter=hurricane_force_diameter)
storms %>%
group_by(name)%>%
summarize(count=n()) %>%
arrange(desc(name)
storms %>%
storms %>%
group_by(name)%>%
arrange(name) %>%
summarize(count=n()) %>%
```
storms %>%
arrange(name) %>%
group_by(name)%>%
summarize(count=n()) %>%
```
storms %>%
arrange(name)
storms %>%
group_by(name)%>%
summarize(count=n()) %>%
```
storms %>%
group_by(name)%>%
summarize(count=n()) %>%
```
storms
storms %>%
group_by(name)%>%
summarize(count=n()) %>%
storms
storms
storms %>%
group_by(name)%>%
summarize(count=n())
storms %>%
group_by(name)%>%
summarize(count=n()) %>%
arrange(count())
storms %>%
group_by(name)%>%
summarize(count=n()) %>%
arrange(count)
arrange(desc(count)
storms %>%
storms %>%
group_by(name)%>%
summarize(count=n()) %>%
arrange(desc(count))
